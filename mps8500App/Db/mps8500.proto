#----------------------------------------------------------------------
#
#  StreamDevice protocol file for a reading/setting selected elements
#  from a Danfysik SYS-8500 power supply
#
#  started from  J.Priller's SYS9100.proto
#  2016-08-01  J.Priller  original version
#
#
#  author : Jeong Han Lee
#  email  : jeonghan.lee@gmail.com
#  Date   : 
#  version : 0.0.1
#
#----------------------------------------------------------------------

#Terminator = LF CR;

OutTerminator = CR;
InTerminator = LF CR;
    
ReplyTimeout = 1000;
ReadTimeout  = 300;

#----------------------------------------------------------------------
# $(SYSDEV):Clock
# 
readClock 
{
    out "CLOCK";
    in  "%s";
    ExtraInput = Ignore;
}

#----------------------------------------------------------------------
# $(SYSDEV):RMT_RSTS
#
getRemoteMode {
    out "CMD";
    in "%{LOC|REM}";
    ExtraInput = Ignore;
}

#----------------------------------------------------------------------
# $(SYSDEV):RMT_CM
#
setRemoteMode {
    out "%{LOC|REM}";
    @init {getRemoteMode;}
}

# ----------------------------------------------------------------------
# $(SYSDEV):RLOC_CMD ($(SYSDEV):RLOC_RSTS) 
#
setRemLock {
    out "RLOCK";
    in "%(\$1.VAL)39c"      
}


debug {
    ExtraInput = Ignore;
    out "%s"; in "%39c"
}






#----------------------------------------------------------------------
# get raw status word (6-byte hex)
#
getStatusWord1 {
  out "S1H";
  in "%06X";
}

#----------------------------------------------------------------------
# get an AD reading
#
getAD {
  out "AD \$1";
  in "%d";
}

#----------------------------------------------------------------------
# on/off
#
setOnOff {
  out "%{F|N}";
}

#----------------------------------------------------------------------
# reset
#
reset {
  out "RS";
}

#----------------------------------------------------------------------
# get a DA value
getDA {
  out "DA \$1";
  in "\$1 %d";
}

#----------------------------------------------------------------------
# set a DA value
setDA {
  out "DA \$1 %d";
}




#----------------------------------------------------------------------
# send a raw command
#
sendRawCommand {
  out "%s";
}

#----------------------------------------------------------------------
# send a raw query (needs argument for PV to receive reply)
#
sendRawQuery {
  ExtraInput = Ignore;
  out "%s";
  in  "%(\$1)40c";
}

#----------------------------------------------------------------------

